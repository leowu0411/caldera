---

- id: a7b8c9d0-1e2f-3a4b-5c6d-7e8f9a0b1c2d
  name: Modbus - Write Tag
  description: |
    Modbus Write Tag: Write a value to a specific tag in the device

    This function writes a value to a tag in a Modbus device using tag ID. Tags are device-specific identifiers that map to register addresses and data types, allowing for more intuitive interaction with industrial control systems. This can be used to modify process control parameters.
  tactic: impair-process-control
  technique_id: T0836
  technique_name: Modify Parameter
  executors:
  - platform: linux
    name: sh
    command: >
      ./modbus_cli #{modbus.server.ip} --port #{modbus.server.port} write_tag #{modbus.write_tag.tag_id} #{modbus.write_tag.value} --device #{modbus.device.id}
    payloads:
    - modbus_cli
  - platform: windows
    name: psh
    command: >
      .\modbus_cli.exe #{modbus.server.ip} --port #{modbus.server.port} write_tag #{modbus.write_tag.tag_id} #{modbus.write_tag.value} --device #{modbus.device.id}
    payloads:
    - modbus_cli.exe
